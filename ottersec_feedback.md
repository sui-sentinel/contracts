Issues
1. In consume_prompt, the relationship between the Agent and the Enclave is not verified, so an attacker could use a signature generated by a fake Enclave to win
2. Since agent_list in AgentRegistry is a vector<String>, an attacker can create a large number of agents and push the object size up to max_move_object_size
3. An attacker can call fund_agent with 0 SUI and block the creator from calling withdraw_from_agent
4. The creator can delete the Enclave to avoid paying out the rewards accumulated on the Agent. Meanwhile, withdraw_from_agent is still callable even without an Enclave
5. If a user creates an agent and never call fund_agent, then last_funded_timestamp stays at 0. but if someone submits a request for attack, the creator can steal that reward through withdraw_from_agent
6. Since multiple enclave's config can be created by a module, its possible to create an enclave using one, and then use a different config to destroy it (if the later has a bigger version).
7. Outdated enclaves can still be used
8. There are no timestamp checks for signatures, so an user could keep the signature and wait until the agent get more funds to execute the attack. We recommend adding an expiration for the signatures
9. Requiring a one time witness for enclave::new_cap would make it safer as it would be impossible for others to create caps (and therefore configs and enclaves) using the same type as a module

Suggestions
1. Since the epoch length is 1 day, sui random module can be used here
2. AgentCap can be used instead of Attack.admin
3. We suggest replacing 95 here with a configurable value
4. For PromptConsumed, it’d be better to use the success value that’s passed in as an argument here
5. This check looks redundant, since Attacker is an owned object
6. Setter function that emit events such as sentinel::update_protocol_wallet could check if the new value is different from old one for avoiding emitting unnecessary events
7. We think enclave::deploy_old_enclave_by_owner was supposed to be called destroy_old_enclave_by_owner. Also, this function destroys the enclave without checking its version, so maybe it should be called destroy_enclave_by_owner

Questions
1. When a creator calls update_agent_prompt, are we assuming that the enclave’s PCR also changes, or does it stay the same?
